<!DOCTYPE html>

<html lang="zh-TW">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>昆雅泰式料理 Khunya Thai Cuisine｜板橋泰式家常菜線上菜單</title>
<meta content="昆雅泰式料理 Khunya Thai Cuisine｜板橋泰式家常菜線上菜單，支援中文 / 泰文 / 英文切換。主打打拋飯、泰式炒河粉、清邁金麵、泰式船麵與泰式奶茶。" name="description"/>
<link href="https://khunyathai.com/" rel="canonical"/>
<meta content="website" property="og:type"/>
<meta content="昆雅泰式料理 Khunya Thai Cuisine｜線上菜單" property="og:title"/>
<meta content="板橋泰式家常菜線上菜單，支援中文 / 泰文 / 英文切換。" property="og:description"/>
<meta content="https://khunyathai.com/" property="og:url"/>
<meta content="https://khunyathai.com/images/hero/1.jpeg" property="og:image"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.6.0/remixicon.min.css" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700;800&amp;family=Noto+Sans+TC:wght@400;500;700;800&amp;family=Kanit:wght@400;500;700&amp;display=swap" rel="stylesheet"/>
<style>
    :root{
      /* uniam.jp inspired: soft lavender + warm neutrals */
      --bg: #E9E0F2;
      --surface: #FFFFFF;
      --surface2: rgba(255,255,255,0.75);
      --text: #151515;
      --muted: rgba(21,21,21,0.62);
      --line: rgba(21,21,21,0.10);

      --pill: rgba(21,21,21,0.06);
      --pillText: rgba(21,21,21,0.70);

      --accent: #111111;
      --danger: #C63C3C;

      --radius-lg: 22px;
      --radius-md: 16px;
      --radius-sm: 12px;

      --shadow: 0 12px 30px rgba(0,0,0,0.10);
      --shadow-soft: 0 8px 18px rgba(0,0,0,0.08);
    }

    *{ box-sizing: border-box; }
    html, body{ height: 100%; }
    body{
      margin: 0;
      font-family: 'Noto Sans TC','Kanit',system-ui,-apple-system,"Segoe UI",sans-serif;
      background: var(--bg);
      color: var(--text);
      overflow-x: hidden;
      -webkit-font-smoothing: antialiased;
    }

    .container{
      max-width: 1100px;
      margin: 0 auto;
      padding: 18px 14px 80px;
    }
    @media (min-width: 768px){
      .container{ padding: 28px 22px 90px; }
    }

    /* Top brand header */
    header{
      position: relative;
      text-align: left;
      padding: 10px 2px 18px;
    }
    .brand-row{
      display:flex;
      align-items:flex-end;
      justify-content:space-between;
      gap: 12px;
      flex-wrap: wrap;
    }
    .brand-title{
      font-weight: 800;
      letter-spacing: 0.02em;
      font-size: clamp(28px, 4.5vw, 46px);
      line-height: 1.05;
    }
    .brand-sub{
      font-size: 12px;
      letter-spacing: 0.16em;
      text-transform: uppercase;
      color: var(--muted);
      margin-top: 6px;
    }

    /* Fixed hamburger */
    .nav-wrapper{
      position: fixed;
      top: 14px;
      right: 14px;
      z-index: 999;
    }
    .nav-toggle{
      width: 42px; height: 42px;
      border-radius: 999px;
      border: 1px solid var(--line);
      background: rgba(255,255,255,0.80);
      backdrop-filter: blur(10px);
      box-shadow: 0 6px 18px rgba(0,0,0,0.08);
      display:flex;
      align-items:center;
      justify-content:center;
      cursor: pointer;
      transition: transform 0.15s ease, background 0.15s ease;
    }
    .nav-toggle:hover{ transform: translateY(-1px); background: rgba(255,255,255,0.92); }
    .nav-toggle i{ font-size: 20px; color: var(--text); }

    .nav-menu{
      position:absolute;
      top: 50px;
      right: 0;
      min-width: 240px;
      background: rgba(255,255,255,0.92);
      backdrop-filter: blur(12px);
      border: 1px solid var(--line);
      border-radius: 18px;
      box-shadow: var(--shadow-soft);
      padding: 8px 0;
      display:none;
    }
    .nav-menu.open{ display:block; }
    .nav-menu-item{
      width:100%;
      background: transparent;
      border: none;
      text-align:left;
      padding: 10px 14px;
      display:flex;
      gap: 10px;
      align-items:center;
      cursor:pointer;
      font-size: 13px;
      color: var(--text);
    }
    .nav-menu-item:hover{ background: rgba(21,21,21,0.05); }
    .nav-menu-item i{ font-size: 18px; color: rgba(21,21,21,0.75); }
    .nav-menu-divider{ height:1px; background: var(--line); margin: 6px 0; }
    .nav-menu-lang-label{ padding: 6px 14px 2px; font-size: 11px; color: var(--muted); }
    .nav-menu-lang-buttons{ padding: 6px 14px 12px; display:flex; gap: 8px; }
    .lang-btn{
      border: 1px solid var(--line);
      background: rgba(21,21,21,0.04);
      border-radius: 999px;
      padding: 5px 10px;
      font-size: 12px;
      cursor:pointer;
      color: rgba(21,21,21,0.75);
      transition: all 0.15s ease;
    }
    .lang-btn.active{
      background: var(--accent);
      color: #fff;
      border-color: rgba(0,0,0,0);
    }

    /* HERO */
    .hero{
      position: relative;
      border-radius: var(--radius-lg);
      overflow: hidden;
      box-shadow: var(--shadow);
      background: #000;
      margin-top: 8px;
    }
    .hero-stage{
      position: relative;
      width: 100%;
      height: min(68vh, 620px);
    }
    @media (max-width: 520px){
      .hero-stage{ height: 62vh; }
    }
    .hero-slide{
      position:absolute;
      inset: 0;
      opacity: 0;
      transition: opacity 0.45s ease;
    }
    .hero-slide.active{ opacity: 1; }
    .hero-slide img{
      width:100%; height:100%;
      object-fit: cover;
      display:block;
      filter: saturate(1.05) contrast(1.05);
    }
    .hero-overlay{
      position:absolute;
      inset: 0;
      background: linear-gradient(180deg, rgba(0,0,0,0.55) 0%, rgba(0,0,0,0.26) 45%, rgba(0,0,0,0.62) 100%);
      pointer-events:none;
    }
    .hero-content{
      position:absolute;
      inset: 0;
      padding: 18px 16px;
      display:flex;
      flex-direction: column;
      justify-content: flex-end;
      gap: 10px;
    }
    @media (min-width: 900px){
      .hero-content{
        justify-content: center;
        padding: 28px 30px;
        max-width: 520px;
      }
    }
    .hero-kicker{
      display:inline-flex;
      gap: 8px;
      align-items:center;
      padding: 6px 10px;
      border-radius: 999px;
      background: rgba(255,255,255,0.20);
      border: 1px solid rgba(255,255,255,0.22);
      width: fit-content;
      color: rgba(255,255,255,0.95);
      font-size: 12px;
      letter-spacing: 0.08em;
    }
    .hero-title{
      font-size: clamp(26px, 5vw, 44px);
      font-weight: 800;
      line-height: 1.1;
      color: #fff;
      margin: 0;
    }
    .hero-desc{
      margin: 0;
      color: rgba(255,255,255,0.86);
      font-size: 14px;
      line-height: 1.65;
      max-width: 48ch;
    }
    .hero-meta{
      color: rgba(255,255,255,0.82);
      font-size: 12px;
      line-height: 1.6;
    }
    .hero-ctas{
      display:flex;
      gap: 10px;
      flex-wrap: wrap;
      margin-top: 6px;
    }
    .cta{
      display:inline-flex;
      align-items:center;
      gap: 8px;
      padding: 10px 12px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,0.22);
      background: rgba(255,255,255,0.16);
      color: #fff;
      text-decoration:none;
      font-size: 13px;
      backdrop-filter: blur(10px);
      transition: transform 0.15s ease, background 0.15s ease;
    }
    .cta:hover{ transform: translateY(-1px); background: rgba(255,255,255,0.22); }
    .cta i{ font-size: 18px; }

    /* dots ultra subtle */
    .hero-dots{
      position:absolute;
      left: 50%;
      transform: translateX(-50%);
      bottom: 16px;
      display:flex;
      gap: 6px;
      opacity: 0.10;
      transition: opacity 0.3s ease;
    }
    .hero:hover .hero-dots,
    .hero:active .hero-dots,
    .hero:focus-within .hero-dots{ opacity: 0.45; }

    .hero-dot{
      width: 14px;
      height: 1.5px;
      border-radius: 999px;
      background: rgba(255,255,255,0.6);
      cursor:pointer;
      transition: all 0.25s ease;
    }
    .hero-dot.active{
      background: rgba(255,255,255,0.95);
      transform: scaleX(1.3);
    }

    /* Desktop: show 3 thumbnails on right, 1-2-3 */
    .hero-thumbs{
      display:none;
      position:absolute;
      top: 18px;
      right: 18px;
      gap: 10px;
      z-index: 3;
    }
    @media (min-width: 900px){
      .hero-thumbs{ display:flex; }
      .hero-content{ inset: 0 auto 0 0; }
    }
    .hero-thumb{
      width: 120px;
      height: 78px; /* 4:3-ish */
      border-radius: 14px;
      overflow:hidden;
      border: 1px solid rgba(255,255,255,0.20);
      opacity: 0.78;
      cursor:pointer;
      box-shadow: 0 10px 22px rgba(0,0,0,0.22);
      transform: translateY(0);
      transition: opacity 0.15s ease, transform 0.15s ease;
      background:#111;
    }
    .hero-thumb img{ width:100%; height:100%; object-fit: cover; display:block; }
    .hero-thumb.active{ opacity: 1; transform: translateY(-1px); border-color: rgba(255,255,255,0.45); }

    /* Sections */
    main{ display:flex; flex-direction: column; gap: 36px; margin-top: 18px; }
    section{ scroll-margin-top: 88px; }
    .section-head{
      display:flex;
      justify-content: space-between;
      align-items:flex-end;
      gap: 12px;
      margin: 4px 2px 10px;
    }
    .section-title{
      font-size: 24px;
      font-weight: 800;
      letter-spacing: 0.01em;
      margin: 0;
    }
    .section-sub{
      margin: 0;
      font-size: 13px;
      color: var(--muted);
      line-height: 1.5;
      max-width: 70ch;
    }

    /* MENU: Featured strip like Uber */
    .featured-strip{
      display:flex;
      gap: 12px;
      overflow-x:auto;
      padding: 6px 2px 12px;
      scroll-snap-type: x mandatory;
      scrollbar-width: thin;
    }
    .featured-strip::-webkit-scrollbar{ height: 6px; }
    .featured-strip::-webkit-scrollbar-thumb{ background: rgba(21,21,21,0.20); border-radius: 999px; }

    /* MENU carousel (left/right swipe) */
    .menu-carousel{
      display: flex;
      gap: 14px;
      overflow-x: auto;
      padding: 6px 2px 12px;
      margin-top: 10px;
      scroll-snap-type: x mandatory;
      -webkit-overflow-scrolling: touch;
      scrollbar-width: none; /* Firefox */
    }
    .menu-carousel::-webkit-scrollbar{ display:none; }

    .menu-carousel .card{
      flex: 0 0 82%;
      scroll-snap-align: start;
    }
    @media (min-width: 768px){
      .menu-carousel .card{ flex-basis: 340px; }
    }
    @media (min-width: 1200px){
      .menu-carousel .card{ flex-basis: 360px; }
    }

    .card{
      background: var(--surface);
      border: 1px solid var(--line);
      border-radius: var(--radius-md);
      overflow:hidden;
      box-shadow: 0 10px 22px rgba(0,0,0,0.06);
      cursor:pointer;
      transform: translateY(0);
      transition: transform 0.15s ease, box-shadow 0.15s ease;
    }
    .card:hover{
      transform: translateY(-2px);
      box-shadow: 0 16px 36px rgba(0,0,0,0.10);
    }

    .card-img{
      width:100%;
      aspect-ratio: 4 / 3; /* requested */
      object-fit: cover;
      display:block;
      background: rgba(0,0,0,0.06);
    }

    .card-body{
      padding: 12px 12px 12px;
      display:flex;
      flex-direction: column;
      gap: 8px;
    }
    .card-top{
      display:flex;
      justify-content: space-between;
      gap: 10px;
      align-items:flex-start;
    }
    .card-name{
      font-size: 15px;
      font-weight: 800;
      line-height: 1.25;
      letter-spacing: 0.01em;
    }
    .card-code{
      font-size: 11px;
      color: var(--muted);
      letter-spacing: 0.06em;
      margin-top: 2px;
    }
    .card-price{
      font-size: 16px;
      font-weight: 900;
      color: var(--danger);
      white-space: nowrap;
    }

    .pills{
      display:flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 2px;
    }
    .pill{
      display:inline-flex;
      align-items:center;
      gap: 6px;
      padding: 6px 10px;
      border-radius: 999px;
      background: var(--pill);
      color: var(--pillText);
      font-size: 12px;
      line-height: 1;
      border: 1px solid rgba(21,21,21,0.06);
    }
    .pill i{ font-size: 15px; }
    .pill.hot{ background: rgba(255,80,80,0.10); color: rgba(150,20,20,0.85); }

    .card-desc{
      font-size: 12px;
      color: var(--muted);
      line-height: 1.55;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow:hidden;
      min-height: 2.9em;
    }

    /* Category tabs */
    .category-tabs{
      display:flex;
      gap: 10px;
      overflow-x:auto;
      padding: 10px 2px 8px;
      border-top: 1px solid var(--line);
      border-bottom: 1px solid var(--line);
      background: rgba(255,255,255,0.55);
      backdrop-filter: blur(10px);
      border-radius: 18px;
    }
    .category-tab{
      flex: 0 0 auto;
      border-radius: 999px;
      border: 1px solid rgba(21,21,21,0.12);
      padding: 8px 12px;
      font-size: 13px;
      color: rgba(21,21,21,0.70);
      background: rgba(255,255,255,0.75);
      cursor:pointer;
      transition: all 0.15s ease;
      white-space: nowrap;
    }
    .category-tab.active{
      background: var(--accent);
      color: #fff;
      border-color: rgba(0,0,0,0);
    }

    /* Carousel: coverflow for photo/review */
    .coverflow{
      position: relative;
      padding: 4px 0 0;
    }
    .coverflow-track{
      display:flex;
      gap: 14px;
      overflow-x:auto;
      scroll-snap-type: x mandatory;
      padding: 10px 2px 14px;
      scrollbar-width: thin;
    }
    .coverflow-track::-webkit-scrollbar{ height: 6px; }
    .coverflow-track::-webkit-scrollbar-thumb{ background: rgba(21,21,21,0.20); border-radius: 999px; }

    .coverflow-item{
      flex: 0 0 72%;
      scroll-snap-align: center;
      border-radius: var(--radius-lg);
      overflow:hidden;
      border: 1px solid var(--line);
      box-shadow: var(--shadow-soft);
      background: var(--surface);
      transform: scale(0.92);
      filter: blur(1.4px) saturate(0.92);
      transition: transform 0.22s ease, filter 0.22s ease, opacity 0.22s ease;
      opacity: 0.72;
      cursor: pointer;
    }
    @media (min-width: 768px){
      .coverflow-item{ flex-basis: 42%; }
    }
    .coverflow-item.is-active{
      transform: scale(1.0);
      filter: blur(0) saturate(1);
      opacity: 1;
    }
    .coverflow-img{
      width:100%;
      aspect-ratio: 3/4;
      object-fit: cover;
      display:block;
      background: rgba(0,0,0,0.06);
    }
    .coverflow-img.contain{
      aspect-ratio: auto;
      object-fit: contain;
      background: transparent;
      padding: 10px;
    }

    /* Map button */
    .map-btn{
      display:inline-flex;
      align-items:center;
      gap: 8px;
      padding: 10px 14px;
      border-radius: 999px;
      background: rgba(255,255,255,0.75);
      border: 1px solid var(--line);
      text-decoration:none;
      color: var(--text);
      font-size: 13px;
      box-shadow: 0 10px 22px rgba(0,0,0,0.06);
    }
    .map-btn i{ font-size: 18px; color: #EA4335; }

    /* About / Contact */
    .panel{
      background: rgba(255,255,255,0.75);
      backdrop-filter: blur(10px);
      border: 1px solid var(--line);
      border-radius: var(--radius-lg);
      padding: 16px 16px;
      box-shadow: 0 10px 22px rgba(0,0,0,0.06);
    }
    .about-text, .contact-text{
      font-size: 14px;
      line-height: 1.85;
      color: rgba(21,21,21,0.82);
    }
    .contact-grid{
      display:grid;
      grid-template-columns: 1fr;
      gap: 10px;
      margin-top: 10px;
      font-size: 14px;
      color: rgba(21,21,21,0.85);
    }
    .kv{ display:flex; gap: 10px; flex-wrap: wrap; }
    .k{ min-width: 86px; color: rgba(21,21,21,0.62); font-weight: 700; letter-spacing: 0.02em;}
    .v{ flex: 1; }

    footer{
      margin-top: 50px;
      padding: 22px 0 0;
      border-top: 1px solid var(--line);
      color: rgba(21,21,21,0.55);
      font-size: 12px;
      letter-spacing: 0.12em;
      text-transform: uppercase;
    }

    /* Modal */
    .modal{
      position: fixed;
      inset: 0;
      display:none;
      align-items:center;
      justify-content:center;
      padding: 18px;
      z-index: 3000;
    }
    .modal.show{ display:flex; }
    .modal-backdrop{
      position:absolute; inset:0;
      background: rgba(0,0,0,0.68);
      backdrop-filter: blur(6px);
    }
    .modal-card{
      position: relative;
      width: min(720px, 100%);
      max-height: 88vh;
      overflow: auto;
      background: #fff;
      border-radius: 22px;
      box-shadow: 0 22px 60px rgba(0,0,0,0.32);
      border: 1px solid rgba(255,255,255,0.18);
    }
    .modal-img{
      width: 100%;
      aspect-ratio: 4/3;
      object-fit: cover;
      display:block;
      background: rgba(0,0,0,0.06);
    }
    .modal-body{ padding: 14px 16px 16px; }
    .modal-row{
      display:flex;
      justify-content: space-between;
      gap: 12px;
      align-items:flex-start;
    }
    .modal-name{ font-size: 18px; font-weight: 900; line-height: 1.25; }
    .modal-price{ font-size: 18px; font-weight: 900; color: var(--danger); }
    .modal-desc{ margin-top: 10px; font-size: 13px; color: rgba(21,21,21,0.75); line-height: 1.7; }
    .modal-options{
      margin-top: 12px;
      padding-top: 12px;
      border-top: 1px solid var(--line);
      display:flex;
      flex-direction: column;
      gap: 10px;
      font-size: 13px;
      color: rgba(21,21,21,0.82);
    }
    .opt{
      display:flex;
      flex-direction: column;
      gap: 6px;
      background: rgba(21,21,21,0.03);
      border: 1px solid rgba(21,21,21,0.06);
      border-radius: 14px;
      padding: 10px 12px;
    }
    .opt label{ font-weight: 800; display:flex; gap: 8px; align-items:center; }
    .opt label i{ font-size: 18px; }
    .opt small{ color: rgba(21,21,21,0.62); line-height: 1.5; }
    .opt select, .opt input[type="range"]{
      width: 100%;
      margin-top: 4px;
    }
    .modal-close{
      position:absolute;
      top: 10px;
      right: 10px;
      width: 40px; height: 40px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,0.35);
      background: rgba(0,0,0,0.35);
      color:#fff;
      display:flex;
      align-items:center;
      justify-content:center;
      cursor:pointer;
      backdrop-filter: blur(10px);
    }
    .modal-close i{ font-size: 20px; }

    /* Loading */
    .loading{ font-size: 13px; color: var(--muted); padding: 14px 2px; }
    .error{ font-size: 13px; color: #B14B4B; padding: 14px 2px; }

  
    
/* =========================
   uniam.jp-ish UI refinement (clean, flat, higher-contrast lines)
   ========================= */
:root{
  --bg: #E9E0F2;                 /* soft lavender */
  --surface: #FFFFFF;
  --surface2: rgba(255,255,255,0.78);
  --text: #111111;
  --muted: rgba(17,17,17,0.62);

  /* more visible borders */
  --line: rgba(17,17,17,0.22);

  --pill: rgba(17,17,17,0.04);
  --pillText: rgba(17,17,17,0.72);

  --accent: #111111;
  --danger: #111111;             /* monochrome price like uniam */

  --radius-lg: 26px;
  --radius-md: 18px;
  --radius-sm: 12px;

  /* keep shadows very subtle */
  --shadow: 0 10px 22px rgba(0,0,0,0.10);
  --shadow-soft: 0 8px 18px rgba(0,0,0,0.08);
}

/* Cards: crisper border, minimal hover */
.card{
  border: 1.5px solid var(--line);
  box-shadow: 0 8px 18px rgba(0,0,0,0.06);
  transition: border-color 0.15s ease, transform 0.15s ease, box-shadow 0.15s ease;
}
.card:hover{
  transform: translateY(-1px);
  box-shadow: 0 12px 26px rgba(0,0,0,0.08);
  border-color: rgba(17,17,17,0.32);
}

/* Menu card image: 1:1 (Uber-like grid) */
.card-img{
  aspect-ratio: 1 / 1;
}

/* Pills: slightly stronger outline */
.pill{
  border: 1px solid rgba(17,17,17,0.18);
}

/* Category tabs: cleaner lines */
.category-tabs{
  border-top: 1.5px solid var(--line);
  border-bottom: 1.5px solid var(--line);
}
.category-tab{
  border: 1px solid rgba(17,17,17,0.18);
}
.category-tab.active{
  border-color: rgba(0,0,0,0);
}

/* Panels: slightly stronger outline */
.panel{
  border: 1.5px solid var(--line);
  box-shadow: none;
}

/* Modal: match card line weight */
.modal-card{
  border: 1.5px solid rgba(17,17,17,0.22);
}

/* Hero: keep rounded + clean border */
.hero{
  border: 1.5px solid rgba(255,255,255,0.18);
}


  
/* ===== v6: Japanese-minimal tuning (Uniam-like) ===== */
:root{
  --bg:#EFEAF7;
  --card:#FFFFFF;
  --border:#D8D1E6;
  --border-strong:#BFB5DA;
  --text:#171717;
  --muted:#6D6A75;
  --accent:#1B1B1B;
  --pill:#F6F3FB;
}

body{
  background: var(--bg) !important;
  color: var(--text) !important;
  letter-spacing: 0.01em;
}

.brand-logo{
  letter-spacing: 0.14em;
  font-weight: 800;
}

.brand-subtitle{
  color: var(--muted);
  letter-spacing: 0.28em;
}

.section-title-large{
  color: var(--text);
  font-weight: 800;
  letter-spacing: 0.02em;
}

.section-title-subtext{
  color: var(--muted);
}

/* Cards (menu + featured) */
.featured-card,
.menu-item,
.menu-card{
  background: var(--card) !important;
  border: 1.5px solid var(--border) !important;
  border-radius: 18px !important;
  box-shadow: none !important;
  transform: none !important;
}

.featured-card:hover,
.menu-item:hover,
.menu-card:hover{
  border-color: var(--border-strong) !important;
  box-shadow: 0 6px 18px rgba(17, 12, 46, 0.06) !important; /* very soft */
  transform: none !important; /* keep calm */
}

.item-name-main,
.featured-name{
  color: var(--text) !important;
  font-weight: 700 !important;
  letter-spacing: 0.01em;
}

.item-price,
.featured-price{
  color: var(--text) !important;
  font-weight: 800 !important;
}

/* Image ratio: 1:1 for dish cards */
.menu-card .card-img,
.menu-item .card-img,
.featured-img{
  aspect-ratio: 1 / 1 !important;
  object-fit: cover !important;
  background: #EEE7F4 !important;
}

/* Pills */
.item-badge,
.pill,
.tag-pill{
  border-radius: 999px !important;
  border: 1px solid var(--border) !important;
  background: var(--pill) !important;
  color: var(--text) !important;
  font-weight: 650;
}

/* Dots ultra-minimal */
.hero-dots{
  opacity: 0.10 !important;
}
.hero-section:hover .hero-dots,
.hero-section:active .hero-dots,
.hero-section:focus-within .hero-dots{
  opacity: 0.38 !important;
}

/* Buttons (calm) */
.hero-btn-primary,
.hero-btn-secondary,
.review-button{
  border-radius: 999px !important;
  border: 1px solid var(--border) !important;
  box-shadow: none !important;
}
.hero-btn-primary{
  background: var(--accent) !important;
  border-color: var(--accent) !important;
}
.hero-btn-secondary,
.review-button{
  background: rgba(255,255,255,0.7) !important;
}
.hero-btn-secondary:hover,
.review-button:hover{
  background: rgba(255,255,255,0.9) !important;
  transform: none !important;
}

/* Modal */
.modal,
.lightbox img{
  border-radius: 18px !important;
}



/* ===== v7 adjustments: remove pictures/reviews, stronger CTA, unified radius, 50/50 cards ===== */
:root{
  --radius-lg: 20px;
  --radius-md: 18px;
  --radius-sm: 18px;
}

/* Primary CTA: obvious color */
.cta-primary{
  background: #FF4D2D !important;
  border-color: #FF4D2D !important;
  color: #ffffff !important;
}
.cta-primary:hover{
  background: #FF3A17 !important;
  border-color: #FF3A17 !important;
}

/* Unify corners across site */
.hero{ border-radius: var(--radius-lg) !important; }
.nav-menu{ border-radius: var(--radius-lg) !important; }
.category-tabs{ border-radius: var(--radius-lg) !important; }
.panel{ border-radius: var(--radius-lg) !important; }
.modal-card{ border-radius: var(--radius-lg) !important; }
.hero-thumb{ border-radius: var(--radius-md) !important; }
.opt{ border-radius: var(--radius-md) !important; }

/* Card layout: image/text 50/50 */
.card{
  display: flex !important;
  align-items: stretch;
}
.card-media{
  flex: 0 0 50%;
  max-width: 50%;
  background: rgba(0,0,0,0.06);
}
.card-media .card-img{
  width: 100%;
  height: 100%;
  aspect-ratio: 1 / 1;          /* keep dish photo square */
  object-fit: cover;
  display:block;
}

/* Body takes other half */
.card-body{
  flex: 0 0 50%;
  max-width: 50%;
  padding: 14px 14px 14px !important;
}

/* Typography: calmer spacing (more Japanese-minimal) */
.card-name{
  letter-spacing: 0.02em !important;
  line-height: 1.35 !important;
}
.card-price{
  letter-spacing: 0.01em !important;
}
.card-desc{
  line-height: 1.75 !important;
  letter-spacing: 0.01em !important;
}

/* Better on very small screens: keep 50/50 but reduce padding */
@media (max-width: 380px){
  .card-body{ padding: 12px !important; }
}

/* Featured cards keep same 50/50 rule */
.featured-strip .card{
  flex: 0 0 78%;
  max-width: 560px;
  scroll-snap-align: start;
}
@media (min-width: 768px){
  .featured-strip .card{ flex-basis: 520px; }
}
</style>
</head>
<body>
<div class="nav-wrapper">
<button aria-label="Open navigation" class="nav-toggle" id="navToggle">
<i class="ri-menu-line"></i>
</button>
<div class="nav-menu" id="navMenu">
<button class="nav-menu-item" data-target="menu"><i class="ri-restaurant-line"></i><span id="navMenuLabel">菜單</span></button>


<button class="nav-menu-item" data-target="about"><i class="ri-store-2-line"></i><span id="navAboutLabel">關於我們</span></button>
<button class="nav-menu-item" data-target="contact"><i class="ri-chat-1-line"></i><span id="navContactLabel">聯絡我</span></button>
<div class="nav-menu-divider"></div>
<div class="nav-menu-lang-label" id="navLangLabel">語言 / Language</div>
<div class="nav-menu-lang-buttons" id="langSwitch">
<button class="lang-btn" data-lang="zh">中</button>
<button class="lang-btn" data-lang="th">TH</button>
<button class="lang-btn" data-lang="en">EN</button>
</div>
</div>
</div>
<div class="container">
<header>
<div class="brand-row">
<div>
<div class="brand-title">KHUNYA THAI</div>
<div class="brand-sub">HOME-STYLE THAI CUISINE • BANQIAO</div>
</div>
</div>
</header>
<!-- HERO -->
<section class="hero" id="home">
<div class="hero-stage" id="heroStage">
<div class="hero-slide active"><img alt="Khunya Thai Hero 1" src="images/hero/1.jpeg"/></div>
<div class="hero-slide"><img alt="Khunya Thai Hero 2" src="images/hero/2.jpeg"/></div>
<div class="hero-slide"><img alt="Khunya Thai Hero 3" src="images/hero/3.jpeg"/></div>
<div class="hero-overlay"></div>
<div class="hero-thumbs" id="heroThumbs">
<div class="hero-thumb active" data-idx="0"><img alt="thumb 1" src="images/hero/1.jpeg"/></div>
<div class="hero-thumb" data-idx="1"><img alt="thumb 2" src="images/hero/2.jpeg"/></div>
<div class="hero-thumb" data-idx="2"><img alt="thumb 3" src="images/hero/3.jpeg"/></div>
</div>
<div class="hero-content">
<h1 class="hero-title" id="heroTitle">昆雅泰式料理</h1>
<p class="hero-desc" id="heroDesc">板橋巷弄裡的泰國家常餐桌：打拋飯、清邁金麵、船麵與泰式奶茶。</p>
<div class="hero-meta" id="heroMeta">Hours｜11:00–14:00, 17:00–21:00 (Closed on Sundays)</div>
<div class="hero-ctas">
<a class="cta cta-primary" href="https://lin.ee/fGU0Rs0L" rel="noopener noreferrer" target="_blank">
<i class="ri-line-line"></i><span id="ctaLine">Chat on LINE</span>
</a>
<a class="cta" href="https://maps.app.goo.gl/RMUuJtk4PQQrqqKH9" rel="noopener noreferrer" target="_blank">
<i class="ri-map-pin-2-line"></i><span id="ctaMap">Open in Maps</span>
</a>
</div>
</div>
<div class="hero-dots" id="heroDots">
<div class="hero-dot active" data-idx="0"></div>
<div class="hero-dot" data-idx="1"></div>
<div class="hero-dot" data-idx="2"></div>
</div>
</div>
</section>
<main>
<!-- MENU -->
<section id="menu">
<div class="section-head">
<div>
<h2 class="section-title" id="menuTitle">Menu</h2>
<p class="section-sub" id="menuSubtitle">Top picks first. Then browse by category.</p>
</div>
</div>
<div class="featured-strip" id="featuredStrip">
<div class="loading" id="featuredLoading">Loading…</div>
</div>
<div class="category-tabs" id="categoryTabs"></div>
<div class="menu-carousel" id="menuGrid">
<div class="loading" id="menuLoading">Loading…</div>
</div>
</section>
<!-- PICTURES -->

<!-- REVIEWS -->

<!-- ABOUT -->
<section id="about">
<div class="section-head">
<div>
<h2 class="section-title" id="aboutTitle">About Us</h2>
</div>
</div>
<div class="panel">
<div class="about-text" id="aboutBody">
            我們不追求華麗擺盤，而是專注在「日常可以常吃、又保留泰國靈魂」的家常菜。醬料、咖哩與湯底堅持自己熬煮，盡量使用原始香料與食材。
          </div>
</div>
</section>
<!-- CONTACT -->
<section id="contact">
<div class="section-head">
<div>
<h2 class="section-title" id="contactTitle">Contact Us</h2>
</div>
</div>
<div class="panel">
<div class="contact-text" id="contactLead">加入 LINE 直接詢問／預訂。</div>
<div style="margin-top:10px;">
<a href="https://lin.ee/fGU0Rs0L" rel="noopener noreferrer" target="_blank">
<img alt="加入好友" border="0" height="36" src="https://scdn.line-apps.com/n/line_add_friends/btn/zh-Hant.png"/>
</a>
</div>
<div class="contact-grid">
<div class="kv"><div class="k" id="kLine">LINE</div><div class="v">@143llbev</div></div>
<div class="kv"><div class="k" id="kAddr">地址</div><div class="v">新北市板橋區文化路一段311之11號</div></div>
<div class="kv"><div class="k" id="kHours">營業時間</div><div class="v">11:00–14:00、17:00–21:00（週日公休）</div></div>
</div>
</div>
</section>
</main>
<footer id="footerText">
      © 2024 KHUNYA THAI CUISINE
    </footer>
</div>
<!-- Modal (menu detail / option selectors) -->
<div class="modal" id="modal">
<div class="modal-backdrop" id="modalBackdrop"></div>
<div aria-label="Menu detail" aria-modal="true" class="modal-card" role="dialog">
<button aria-label="Close" class="modal-close" id="modalClose"><i class="ri-close-line"></i></button>
<img alt="" class="modal-img" id="modalImg" src=""/>
<div class="modal-body">
<div class="modal-row">
<div>
<div class="modal-name" id="modalName">—</div>
<div class="card-code" id="modalCode">—</div>
</div>
<div class="modal-price" id="modalPrice">$—</div>
</div>
<div class="modal-desc" id="modalDesc"></div>
<div class="modal-options" id="modalOptions"></div>
</div>
</div>
</div>
<script>
    (function(){
      // -------- Language --------
      let currentLang = 'zh';
      const langSwitch = document.getElementById('langSwitch');

      const i18n = {
        zh: {
          navMenu: '菜單', navPicture: '照片', navReview:'Google 評論與地圖', navAbout:'關於我們', navContact:'聯絡我', navLang:'語言 / Language',
          heroKicker: '招牌推薦', heroTitle:'昆雅泰式料理', heroDesc:'板橋巷弄裡的泰國家常餐桌：打拋飯、清邁金麵、船麵與泰式奶茶。',
          heroMeta:'營業時間｜11:00–14:00、17:00–21:00（週日公休）',
          ctaLine:'LINE 詢問', ctaMap:'Google 地圖導航',
          menuTitle:'菜單', menuSubtitle:'先看招牌，再用分類瀏覽全部菜單。',
          picsTitle:'照片', picsSubtitle:'像旋轉木馬一樣滑動。',
          reviewTitle:'Google 評論與地圖', reviewSubtitle:'點按開地圖；截圖可左右滑。', mapBtn:'開啟 Google Maps',
          aboutTitle:'關於我們',
          aboutBody:'我們不追求華麗擺盤，而是專注在「日常可以常吃、又保留泰國靈魂」的家常菜。醬料、咖哩與湯底堅持自己熬煮，盡量使用原始香料與食材。',
          contactTitle:'聯絡我', contactLead:'加入 LINE 直接詢問／預訂。',
          kLine:'LINE', kAddr:'地址', kHours:'營業時間',
          loading:'載入中…', loadErr:'載入菜單失敗，請確認 menu.json 是否在同一資料夾',
          pill: { spice:'可調辣度', coriander:'含香菜', peanut:'含花生', ice:'可調甜度/冰塊', rice:'茉莉香米' },
          option: { spice:'辣度', ice:'甜度/冰塊', coriander:'香菜', peanut:'花生' },
          optionHint: { spice:'選擇辣度（僅顯示，不會送出訂單）', ice:'選擇甜度與冰塊（僅顯示，不會送出訂單）' },
          spiceLevels:['不辣','小辣','中辣','大辣','特辣'],
          sugarLevels:['無糖','微糖','半糖','少糖','正常糖'],
          iceLevels:['去冰','微冰','少冰','正常冰']
        },
        th: {
          navMenu: 'เมนู', navPicture: 'รูปภาพ', navReview:'รีวิว & แผนที่ Google', navAbout:'เกี่ยวกับเรา', navContact:'ติดต่อร้าน', navLang:'ภาษา',
          heroKicker: 'เมนูแนะนำ', heroTitle:'คุณย่า อาหารไทย', heroDesc:'อาหารไทยแบบโฮมเมดในบันเฉียว: กะเพรา ข้าวซอย ก๋วยเตี๋ยวเรือ และชาไทย',
          heroMeta:'เวลา｜11:00–14:00, 17:00–21:00 (หยุดวันอาทิตย์)',
          ctaLine:'คุยผ่าน LINE', ctaMap:'เปิดแผนที่',
          menuTitle:'เมนู', menuSubtitle:'เริ่มจากเมนูแนะนำ แล้วเลือกดูตามหมวดหมู่',
          picsTitle:'รูปภาพ', picsSubtitle:'เลื่อนเหมือนคารูเซล',
          reviewTitle:'รีวิว & แผนที่ Google', reviewSubtitle:'กดเพื่อเปิดแผนที่ และเลื่อนรูปรีวิว', mapBtn:'เปิด Google Maps',
          aboutTitle:'เกี่ยวกับเรา',
          aboutBody:'เราเน้นอาหารบ้าน ๆ ที่กินได้ทุกวัน และยังคงความเป็นไทยแท้ น้ำพริก เครื่องแกง และน้ำซุปพยายามทำเองให้มากที่สุด',
          contactTitle:'ติดต่อร้าน', contactLead:'เพิ่ม LINE เพื่อสอบถาม/จอง',
          kLine:'LINE', kAddr:'ที่อยู่', kHours:'เวลา',
          loading:'กำลังโหลด…', loadErr:'โหลดเมนูไม่สำเร็จ โปรดตรวจสอบว่า menu.json อยู่ในโฟลเดอร์เดียวกัน',
          pill: { spice:'ปรับความเผ็ด', coriander:'มีผักชี', peanut:'มีถั่วลิสง', ice:'ปรับหวาน/น้ำแข็ง', rice:'ข้าวหอมมะลิ' },
          option: { spice:'ความเผ็ด', ice:'หวาน/น้ำแข็ง', coriander:'ผักชี', peanut:'ถั่วลิสง' },
          optionHint: { spice:'เลือกความเผ็ด (แสดงผลเท่านั้น)', ice:'เลือกความหวานและน้ำแข็ง (แสดงผลเท่านั้น)' },
          spiceLevels:['ไม่เผ็ด','เผ็ดน้อย','เผ็ดกลาง','เผ็ดมาก','เผ็ดพิเศษ'],
          sugarLevels:['ไม่หวาน','หวานน้อย','หวานครึ่ง','หวานน้อยกว่า','หวานปกติ'],
          iceLevels:['ไม่ใส่น้ำแข็ง','น้ำแข็งน้อย','น้ำแข็งครึ่ง','น้ำแข็งปกติ']
        },
        en: {
          navMenu: 'Menu', navPicture: 'Pictures', navReview:'Google Reviews & Map', navAbout:'About Us', navContact:'Contact Us', navLang:'Language',
          heroKicker: 'Signature Picks', heroTitle:'Khunya Thai Cuisine', heroDesc:'Home-style Thai comfort food in Banqiao: basil rice, khao soi, boat noodles & Thai milk tea.',
          heroMeta:'Hours｜11:00–14:00, 17:00–21:00 (Closed on Sundays)',
          ctaLine:'Chat on LINE', ctaMap:'Open in Maps',
          menuTitle:'Menu', menuSubtitle:'Featured first, then browse by category.',
          picsTitle:'Pictures', picsSubtitle:'Swipe like a carousel.',
          reviewTitle:'Google Reviews & Map', reviewSubtitle:'Open maps, swipe screenshots.', mapBtn:'Open Google Maps',
          aboutTitle:'About Us',
          aboutBody:'We focus on everyday home-style Thai dishes that keep an authentic Thai soul. Many sauces, curries and broths are made in-house.',
          contactTitle:'Contact Us', contactLead:'Add us on LINE for quick questions / reservations.',
          kLine:'LINE', kAddr:'Address', kHours:'Hours',
          loading:'Loading…', loadErr:'Failed to load menu. Please ensure menu.json is in the same folder.',
          pill: { spice:'Adjust spice', coriander:'Coriander', peanut:'Peanut', ice:'Adjust sugar/ice', rice:'Jasmine rice' },
          option: { spice:'Spice', ice:'Sugar / Ice', coriander:'Coriander', peanut:'Peanut' },
          optionHint: { spice:'Choose spice level (display only)', ice:'Choose sugar and ice (display only)' },
          spiceLevels:['No spice','Mild','Medium','Hot','Extra hot'],
          sugarLevels:['0%','25%','50%','75%','100%'],
          iceLevels:['No ice','Light ice','Less ice','Regular ice']
        }
      };

      function detectInitialLang(){
        const nav = (navigator.languages && navigator.languages[0]) || navigator.language || '';
        const l = String(nav).toLowerCase();
        if (l.startsWith('zh')) return 'zh';
        if (l.startsWith('th')) return 'th';
        return 'en';
      }

      function applyTexts(){
        const t = i18n[currentLang];
        const setText = (id, val)=>{ const el = document.getElementById(id); if(el) el.textContent = val; };
        setText('navMenuLabel', t.navMenu);
        setText('navPictureLabel', t.navPicture);
        setText('navReviewLabel', t.navReview);
        setText('navAboutLabel', t.navAbout);
        setText('navContactLabel', t.navContact);
        setText('navLangLabel', t.navLang);

        // Hero badge removed (no Signature Picks pill in hero)
        setText('heroTitle', t.heroTitle);
        setText('heroDesc', t.heroDesc);
        setText('heroMeta', t.heroMeta);

        setText('ctaLine', t.ctaLine);
        setText('ctaMap', t.ctaMap);

        setText('menuTitle', t.menuTitle);
        setText('menuSubtitle', t.menuSubtitle);

        setText('picTitle', t.picsTitle);
        setText('picSubtitle', t.picsSubtitle);

        setText('reviewTitle', t.reviewTitle);
        setText('reviewSubtitle', t.reviewSubtitle);
        setText('mapBtnText', t.mapBtn);

        setText('aboutTitle', t.aboutTitle);
        setText('aboutBody', t.aboutBody);

        setText('contactTitle', t.contactTitle);
        setText('contactLead', t.contactLead);
        setText('kLine', t.kLine);
        setText('kAddr', t.kAddr);
        setText('kHours', t.kHours);

        document.documentElement.lang = (currentLang === 'zh') ? 'zh-TW' : (currentLang === 'th' ? 'th' : 'en');

        // lang btn active
        Array.from(langSwitch.querySelectorAll('.lang-btn')).forEach(b => b.classList.toggle('active', b.dataset.lang === currentLang));
      }

      // -------- Nav menu --------
      const navToggle = document.getElementById('navToggle');
      const navMenu = document.getElementById('navMenu');
      navToggle.addEventListener('click', ()=> navMenu.classList.toggle('open'));
      document.addEventListener('click', (e)=>{
        if(!navMenu.classList.contains('open')) return;
        if(e.target.closest('.nav-wrapper')) return;
        navMenu.classList.remove('open');
      });
      navMenu.addEventListener('click', (e)=>{
        const btn = e.target.closest('.nav-menu-item');
        if(!btn) return;
        const id = btn.dataset.target;
        const el = document.getElementById(id);
        if(el){
          navMenu.classList.remove('open');
          const y = window.scrollY + el.getBoundingClientRect().top - 76;
          window.scrollTo({ top: y, behavior: 'smooth' });
        }
      });

      // -------- Hero carousel --------
      const slides = Array.from(document.querySelectorAll('.hero-slide'));
      const dots = Array.from(document.querySelectorAll('.hero-dot'));
      const thumbs = Array.from(document.querySelectorAll('.hero-thumb'));
      let heroIdx = 0;
      let heroTimer = null;
      let startX = 0, dragging = false;

      function setHero(idx){
        heroIdx = (idx + slides.length) % slides.length;
        slides.forEach((s,i)=> s.classList.toggle('active', i===heroIdx));
        dots.forEach((d,i)=> d.classList.toggle('active', i===heroIdx));
        thumbs.forEach((t,i)=> t.classList.toggle('active', i===heroIdx));
      }
      function nextHero(){ setHero(heroIdx+1); }
      function startHero(){ stopHero(); heroTimer = setInterval(nextHero, 4500); }
      function stopHero(){ if(heroTimer) clearInterval(heroTimer); heroTimer=null; }

      dots.forEach(d=> d.addEventListener('click', ()=> setHero(parseInt(d.dataset.idx,10))));
      thumbs.forEach(t=> t.addEventListener('click', ()=> setHero(parseInt(t.dataset.idx,10))));

      const heroStage = document.getElementById('heroStage');
      heroStage.addEventListener('mouseenter', stopHero);
      heroStage.addEventListener('mouseleave', startHero);

      heroStage.addEventListener('touchstart', (e)=>{
        dragging = true;
        startX = e.touches[0].clientX;
        stopHero();
      }, {passive:true});
      heroStage.addEventListener('touchmove', (e)=>{ if(dragging){} }, {passive:true});
      heroStage.addEventListener('touchend', (e)=>{
        if(!dragging) return;
        dragging = false;
        const endX = (e.changedTouches && e.changedTouches[0]) ? e.changedTouches[0].clientX : startX;
        const dx = endX - startX;
        if(Math.abs(dx) > 35){
          if(dx < 0) setHero(heroIdx+1);
          else setHero(heroIdx-1);
        }
        startHero();
      });

      // -------- Menu data --------
      let globalMenu = [];
      let categories = []; // {id, zh, th, en}
      let currentCategoryId = '';

      const featuredStrip = document.getElementById('featuredStrip');
      const categoryTabs = document.getElementById('categoryTabs');
      const menuGrid = document.getElementById('menuGrid');

      
      const featuredLoadingEl = document.getElementById('featuredLoading');
      const menuLoadingEl = document.getElementById('menuLoading');

      function showLoading(){
        if(featuredLoadingEl) featuredLoadingEl.style.display = '';
        if(menuLoadingEl) menuLoadingEl.style.display = '';
      }
      function hideLoading(){
        if(featuredLoadingEl) featuredLoadingEl.style.display = 'none';
        if(menuLoadingEl) menuLoadingEl.style.display = 'none';
      }
      function showLoadError(){
        const msg = (i18n[currentLang] && i18n[currentLang].loadErr) ? i18n[currentLang].loadErr : 'Failed to load menu.';
        if(featuredLoadingEl){ featuredLoadingEl.textContent = msg; featuredLoadingEl.classList.add('error'); }
        if(menuLoadingEl){ menuLoadingEl.textContent = msg; menuLoadingEl.classList.add('error'); }
      }
function getCategoryLabel(cat){
        if(currentLang==='zh') return cat.zh || cat.en || cat.th || cat.id;
        if(currentLang==='th') return cat.th || cat.en || cat.zh || cat.id;
        return cat.en || cat.zh || cat.th || cat.id;
      }
      function getName(item){
        if(currentLang==='zh') return item.nameZh || item.nameEn || item.nameTh || '';
        if(currentLang==='th') return item.nameTh || item.nameEn || item.nameZh || '';
        return item.nameEn || item.nameZh || item.nameTh || '';
      }
      function getDesc(item){
        if(currentLang==='zh') return item.descZH || '';
        if(currentLang==='th') return item.descTh || '';
        return item.descEn || '';
      }

      function normalizeBoolean(v){
        return v === true || v === 1 || v === '1' || String(v).toLowerCase() === 'true';
      }

      function pickHeroPlaceholder(code){
        // spread placeholders across 3 images
        const n = (code && code.length) ? code.charCodeAt(code.length-1) : 0;
        const idx = n % 3;
        return `images/hero/${idx+1}.jpeg`;
      }

      // Resolve menu images from /menu-images/<code>.(jpg|png|webp)
      function getMenuImageBase(item){
        const code = encodeURIComponent(String(item.code || '').trim());
        return `menu-images/${code}`;
      }

      // Fallback chain: .jpg -> .png -> .webp -> placeholder
      // Used by card images and modal image
      window.__menuImgFallback = function(imgEl){
        const fromUrl = imgEl.dataset.fromurl === '1';
        const base = imgEl.dataset.imgbase;
        const code = (imgEl.dataset.code || '').trim();

        // If imageUrl was provided and failed, fall back to our convention: menu-images/<code>.jpg|png|webp
        if(fromUrl){
          imgEl.dataset.fromurl = '0';
          imgEl.dataset.try = 'jpg';
          imgEl.src = `${base}.jpg`;
          return;
        }

        const tried = imgEl.dataset.try || 'jpg';

        if(tried === 'jpg'){
          imgEl.dataset.try = 'png';
          imgEl.src = `${base}.png`;
          return;
        }
        if(tried === 'png'){
          imgEl.dataset.try = 'webp';
          imgEl.src = `${base}.webp`;
          return;
        }

        // final fallback: hero placeholder
        imgEl.onerror = null;
        imgEl.src = pickHeroPlaceholder(code);
      };

      function buildPills(item){
        const t = i18n[currentLang];
        const pills = [];
        const spicy = normalizeBoolean(item.spice) || normalizeBoolean(item.spices);
        const cori = normalizeBoolean(item.coriander);
        const peanut = normalizeBoolean(item.peanut);
        const ice = normalizeBoolean(item.ice_sugar);
        const rice = normalizeBoolean(item.rice);

        if(spicy) pills.push({icon:'ri-fire-line', text:t.pill.spice, cls:'hot'});
        if(cori) pills.push({icon:'ri-leaf-line', text:t.pill.coriander});
        if(peanut) pills.push({icon:'ri-seedling-line', text:t.pill.peanut});
        if(ice) pills.push({icon:'ri-snowy-line', text:t.pill.ice});
        if(rice && item.type === 'food') pills.push({icon:'ri-bowl-line', text:t.pill.rice});
        return pills;
      }

      function cardHtml(item){
        const name = getName(item);
        const desc = getDesc(item);
        const imgBase = getMenuImageBase(item);
        const img = (item.imageUrl && String(item.imageUrl).trim()) ? String(item.imageUrl).trim() : `${imgBase}.jpg`;
        const fromUrl = (item.imageUrl && String(item.imageUrl).trim()) ? '1' : '0';
        const price = (item.price || item.price === 0) ? `$${item.price}` : '';
        const pills = buildPills(item);

        const pillsHtml = pills.length ? `
          <div class="pills">
            ${pills.map(p=> `<span class="pill ${p.cls||''}"><i class="${p.icon}"></i>${p.text}</span>`).join('')}
          </div>` : '';

        return `
          <article class="card" data-code="${item.code}">
            <div class="card-media">
              <img class="card-img" src="${img}" data-imgbase="${imgBase}" data-fromurl="${fromUrl}" data-try="jpg" data-code="${item.code}" onerror="window.__menuImgFallback(this)" alt="${name}" loading="lazy" decoding="async">
            </div>
            <div class="card-body">
              <div class="card-top">
                <div>
                  <div class="card-name">${name}</div>
                  <div class="card-code">${item.code}</div>
                </div>
                <div class="card-price">${price}</div>
              </div>
              ${desc ? `<div class="card-desc">${desc}</div>` : ''}
              ${pillsHtml}
            </div>
          </article>
        `;
      }

      function renderFeatured(){
        const t = i18n[currentLang];
        const featured = globalMenu.filter(x => normalizeBoolean(x.feature));
        if(!featured.length){
          featuredStrip.innerHTML = '';
          return;
        }
        featuredStrip.innerHTML = featured.map(cardHtml).join('');
        featuredStrip.querySelectorAll('.card').forEach(el=>{ el.addEventListener('click', ()=> openModalByCode(el.dataset.code)); });
      }

      function renderTabs(){
        categoryTabs.innerHTML = categories.map(cat => {
          const label = getCategoryLabel(cat);
          const cls = (cat.id === currentCategoryId) ? 'category-tab active' : 'category-tab';
          return `<button class="${cls}" type="button" data-id="${cat.id}">${label}</button>`;
        }).join('');

        categoryTabs.querySelectorAll('.category-tab').forEach(btn=>{
          btn.addEventListener('click', ()=>{
            currentCategoryId = btn.dataset.id;
            renderTabs();
            renderMenuGrid();
        hideLoading();
      });
        });
      }

      function renderMenuGrid(){
        const items = globalMenu.filter(x => x.categoryZh === currentCategoryId);
        if(!items.length){
          menuGrid.innerHTML = `<div class="loading">${i18n[currentLang].loading}</div>`;
          return;
        }
        menuGrid.innerHTML = items.map(cardHtml).join('');
        menuGrid.querySelectorAll('.card').forEach(el=>{
          el.addEventListener('click', ()=> openModalByCode(el.dataset.code));
        });
      }

      // -------- Modal & options UI --------
      const modal = document.getElementById('modal');
      const modalBackdrop = document.getElementById('modalBackdrop');
      const modalClose = document.getElementById('modalClose');
      const modalImg = document.getElementById('modalImg');
      const modalName = document.getElementById('modalName');
      const modalCode = document.getElementById('modalCode');
      const modalPrice = document.getElementById('modalPrice');
      const modalDesc = document.getElementById('modalDesc');
      const modalOptions = document.getElementById('modalOptions');

      function openModal(item){
        const t = i18n[currentLang];
        const imgBase = getMenuImageBase(item);
        const img = (item.imageUrl && String(item.imageUrl).trim()) ? String(item.imageUrl).trim() : `${imgBase}.jpg`;
        const fromUrl = (item.imageUrl && String(item.imageUrl).trim()) ? '1' : '0';
        modalImg.dataset.imgbase = imgBase;
        modalImg.dataset.fromurl = fromUrl;
        modalImg.dataset.try = 'jpg';
        modalImg.dataset.code = item.code;
        modalImg.onerror = ()=> window.__menuImgFallback(modalImg);
        modalImg.src = img;
        modalImg.alt = getName(item);
        modalName.textContent = getName(item);
        modalCode.textContent = item.code;
        modalPrice.textContent = (item.price || item.price === 0) ? `$${item.price}` : '';
        modalDesc.textContent = getDesc(item);

        const spicy = normalizeBoolean(item.spice) || normalizeBoolean(item.spices);
        const ice = normalizeBoolean(item.ice_sugar);
        const cori = normalizeBoolean(item.coriander);
        const peanut = normalizeBoolean(item.peanut);

        const opts = [];

        if(spicy){
          opts.push(`
            <div class="opt">
              <label><i class="ri-fire-line"></i>${t.option.spice}</label>
              <small>${t.optionHint.spice}</small>
              <input type="range" min="0" max="4" step="1" value="2" oninput="this.nextElementSibling.textContent='${t.spiceLevels[0]}'.replace('${t.spiceLevels[0]}', '${t.spiceLevels[0]}')">
              <small class="spiceLabel">${t.spiceLevels[2] || t.spiceLevels[0]}</small>
            </div>
          `);
        }

        if(ice){
          opts.push(`
            <div class="opt">
              <label><i class="ri-snowy-line"></i>${t.option.ice}</label>
              <small>${t.optionHint.ice}</small>
              <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px; margin-top:6px;">
                <div>
                  <div style="font-weight:800; font-size:12px; color: rgba(21,21,21,0.65); margin-bottom:4px;">Sugar</div>
                  <select>
                    ${t.sugarLevels.map(s=> `<option>${s}</option>`).join('')}
                  </select>
                </div>
                <div>
                  <div style="font-weight:800; font-size:12px; color: rgba(21,21,21,0.65); margin-bottom:4px;">Ice</div>
                  <select>
                    ${t.iceLevels.map(s=> `<option>${s}</option>`).join('')}
                  </select>
                </div>
              </div>
            </div>
          `);
        }

        if(cori){
          opts.push(`
            <div class="opt">
              <label><i class="ri-leaf-line"></i>${t.option.coriander}</label>
              <small>${t.pill.coriander}</small>
            </div>
          `);
        }

        if(peanut){
          opts.push(`
            <div class="opt">
              <label><i class="ri-seedling-line"></i>${t.option.peanut}</label>
              <small>${t.pill.peanut}</small>
            </div>
          `);
        }

        modalOptions.innerHTML = opts.join('') || '';
        modal.classList.add('show');

        // wire spice range label
        const range = modalOptions.querySelector('input[type="range"]');
        const label = modalOptions.querySelector('.spiceLabel');
        if(range && label){
          range.addEventListener('input', ()=>{
            const v = parseInt(range.value,10);
            label.textContent = t.spiceLevels[v] || t.spiceLevels[0];
          });
        }
      }

      function openModalByCode(code){
        const item = globalMenu.find(x => x.code === code);
        if(item) openModal(item);
      }

      function closeModal(){
        modal.classList.remove('show');
        modalImg.src = '';
      }
      modalBackdrop.addEventListener('click', closeModal);
      modalClose.addEventListener('click', closeModal);
      document.addEventListener('keydown', (e)=>{
        if(e.key === 'Escape' && modal.classList.contains('show')) closeModal();
      });

      // -------- Load menu.json --------
      function initMenu(data){
        globalMenu = (data || []).map(x => ({
          ...x,
          code: x.code || x.coed || x.id || '',
          categoryZh: x.categoryZh || '',
          categoryTh: x.categoryTh || '',
          categoryEn: x.categoryEn || '',
          nameZh: x.nameZh || '',
          nameTh: x.nameTh || '',
          nameEn: x.nameEn || '',
          imageUrl: x.imageUrl || null
        }));

        // categories by categoryZh id
        const map = new Map();
        globalMenu.forEach(item=>{
          if(!item.categoryZh) return;
          if(!map.has(item.categoryZh)){
            map.set(item.categoryZh, { id: item.categoryZh, zh: item.categoryZh, th: item.categoryTh, en: item.categoryEn });
          }
        });
        categories = Array.from(map.values());

        currentCategoryId = categories.length ? categories[0].id : '';
        renderFeatured();
        renderTabs();
        renderMenuGrid();
      }

      function loadMenu(){
        showLoading();
        if(featuredLoadingEl){ featuredLoadingEl.classList.remove('error'); }
        if(menuLoadingEl){ menuLoadingEl.classList.remove('error'); }
        setText('featuredLoading', i18n[currentLang].loading);
        setText('menuLoading', i18n[currentLang].loading);
        fetch(new URL('menu.json', window.location.href), { cache: 'no-store' })
          .then(res => {
            if(!res.ok) throw new Error('menu.json load failed');
            return res.json();
          })
          .then(data => initMenu(data))
          .catch(err => {
            console.error(err);
            showLoadError();
            if(featuredStrip) featuredStrip.innerHTML = '';
            if(menuGrid) menuGrid.innerHTML = '';
          });
      }

      // -------- Coverflow active item --------
      function setupCoverflow(trackId){
        const track = document.getElementById(trackId);
        if(!track) return;
        const items = Array.from(track.querySelectorAll('.coverflow-item'));
        const setActiveByCenter = ()=>{
          const rect = track.getBoundingClientRect();
          const cx = rect.left + rect.width/2;
          let best = null, bestDist = Infinity;
          items.forEach(it=>{
            const r = it.getBoundingClientRect();
            const icx = r.left + r.width/2;
            const dist = Math.abs(icx - cx);
            if(dist < bestDist){ bestDist = dist; best = it; }
          });
          items.forEach(it=> it.classList.toggle('is-active', it===best));
        };
        track.addEventListener('scroll', ()=>{
          window.requestAnimationFrame(setActiveByCenter);
        }, {passive:true});
        // initial
        setTimeout(setActiveByCenter, 50);

        // click to modal (reuse modal for image-only)
        items.forEach(it=>{
          it.addEventListener('click', ()=>{
            const img = it.querySelector('img');
            if(!img) return;
            // simple lightbox by using modal image area
            modalImg.onerror = null;
            delete modalImg.dataset.imgbase;
            delete modalImg.dataset.try;
            delete modalImg.dataset.code;
            modalImg.src = img.src;
            modalImg.alt = img.alt || '';
            modalName.textContent = img.alt || '';
            modalCode.textContent = '';
            modalPrice.textContent = '';
            modalDesc.textContent = '';
            modalOptions.innerHTML = '';
            modal.classList.add('show');
          });
        });
      }

      // -------- Language switch events --------
      langSwitch.addEventListener('click', (e)=>{
        const btn = e.target.closest('.lang-btn');
        if(!btn) return;
        const lang = btn.dataset.lang;
        if(!lang || lang === currentLang) return;
        currentLang = lang;
        applyTexts();
        // rerender menu based on language
        renderFeatured();
        renderTabs();
        renderMenuGrid();
      });

      // Init
      currentLang = detectInitialLang();
      applyTexts();
      setHero(0);
      startHero();
      loadMenu();
      setupCoverflow('photoTrack');
      setupCoverflow('reviewTrack');
    })();
  </script>
</body>
</html>
